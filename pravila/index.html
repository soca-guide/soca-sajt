<!doctype html>
<html lang="sl">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=no, maximum-scale=1.0">
  <title>HiÅ¡ni red â€“ Dolina SoÄe</title>
  <link rel="stylesheet" href="../assets/app.css?v=20260220-1">
  <style>
    .rules-page { min-height: 100vh; background: linear-gradient(135deg, #0a1612 0%, #0f1e18 100%); color: #f0fdf4; font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif; }
    .rules-header { position: sticky; top: 0; z-index: 10; background: rgba(16, 32, 32, 0.9); backdrop-filter: blur(20px); border-bottom: 1px solid rgba(34, 211, 238, 0.22); padding: 1rem; padding-top: calc(1rem + env(safe-area-inset-top)); display: flex; align-items: center; gap: 1rem; }
    .rules-back { background: transparent; border: none; color: #f0fdf4; font-size: 1.25rem; cursor: pointer; padding: 0.5rem; line-height: 1; }
    .rules-title { font-size: 1.25rem; font-weight: 700; flex: 1; }
    .rules-body { max-width: 480px; margin: 0 auto; padding: 1rem; padding-bottom: calc(2rem + env(safe-area-inset-bottom)); }
    .rule-item { display: flex; gap: 1rem; margin-bottom: 1.25rem; align-items: flex-start; }
    .rule-icon { font-size: 1.25rem; flex-shrink: 0; }
    .rule-text { margin: 0; line-height: 1.5; }
  </style>
</head>
<body class="rules-page">
  <header class="rules-header">
    <a href="../index.html" id="rulesBack" class="rules-back">â† Nazaj</a>
    <div class="rules-title">HiÅ¡ni red</div>
  </header>
  <main class="rules-body">
    <div class="rule-item"><span class="rule-icon">ğŸ”‡</span><p class="rule-text" data-i18n="rule1">Prosimo za spoÅ¡tovanje miru po 22. uri</p></div>
    <div class="rule-item"><span class="rule-icon">ğŸš­</span><p class="rule-text" data-i18n="rule2">Kajenje je dovoljeno samo na terasi</p></div>
    <div class="rule-item"><span class="rule-icon">ğŸ—‘ï¸</span><p class="rule-text" data-i18n="rule3">Smeti odloÅ¾ite v zabojnik na hodniku</p></div>
    <div class="rule-item"><span class="rule-icon">ğŸ”</span><p class="rule-text" data-i18n="rule4">Zaklenite vrata ob odhodu iz apartmaja</p></div>
    <div class="rule-item"><span class="rule-icon">ğŸšª</span><p class="rule-text" data-i18n="rule5">Check-out ob 11:00. KljuÄe pustite v varnostni Å¡katli</p></div>
  </main>

  <!-- i18n + tenant private rules -->
  <script src="../assets/i18n.js?v=20260220-1"></script>
  <script src="../assets/supabase-client.js?v=20260220-1"></script>
  <script src="../assets/tenant-loader.js?v=20260220-1"></script>
  <script>
  (function () {
    'use strict';

    // â”€â”€ Language detection (same localStorage key as main SPA) â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
    var SUPPORTED = ['sl','en','de','it','pl','cs'];
    function detectLang() {
      var raw = (localStorage.getItem('preferredLanguage') || localStorage.getItem('lang') || '').toLowerCase().trim();
      if (SUPPORTED.indexOf(raw) >= 0) return raw;
      raw = (new URLSearchParams(window.location.search).get('lang') || '').toLowerCase().trim();
      if (SUPPORTED.indexOf(raw) >= 0) return raw;
      return 'sl';
    }
    var lang = detectLang();
    var t = (window.APP && window.APP.translations && window.APP.translations[lang]) || {};

    // Apply [data-i18n] rule items
    document.querySelectorAll('[data-i18n]').forEach(function (el) {
      var key = el.getAttribute('data-i18n');
      if (t[key]) el.textContent = t[key];
    });

    // Header title + browser tab title
    var titleEl = document.querySelector('.rules-title');
    if (titleEl && t.rules) titleEl.textContent = t.rules;
    if (t.rules) document.title = t.rules + ' \u2013 Dolina So\u010de';

    // Back button text (â† kept as prefix)
    var backEl = document.getElementById('rulesBack');
    if (backEl && t.back_btn) backEl.textContent = '\u2190 ' + t.back_btn;

    // HTML lang attribute
    document.documentElement.lang = lang;

    // â”€â”€ Slug / tenant overrides â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
    var slug = new URLSearchParams(window.location.search).get('t') || null;

    // Preserve slug on back link so pressing â† keeps tenant context
    if (slug) {
      if (backEl) backEl.href = '../index.html?t=' + encodeURIComponent(slug);
    }

    if (!slug) return;
    if (!window.TenantLoader || typeof window.TenantLoader.loadOverrides !== 'function') return;

    window.TenantLoader.loadOverrides(slug).then(function (ov) {
      if (!ov || !ov.houseRulesPrivate) return;
      var hr = ov.houseRulesPrivate;

      // Accept both { text: "..." } and { rules: ["...","..."] }
      var text = '';
      if (typeof hr.text === 'string' && hr.text.trim()) {
        text = hr.text.trim();
      } else if (Array.isArray(hr.rules) && hr.rules.length > 0) {
        text = hr.rules.join('\n');
      }
      if (!text) return;

      var section = document.createElement('section');
      section.style.cssText = 'margin-top:1.5rem;padding-top:1rem;border-top:1px solid rgba(34,211,238,0.2);';

      var title = document.createElement('p');
      title.style.cssText = 'font-size:0.78rem;font-weight:600;color:rgba(240,253,244,0.5);text-transform:uppercase;letter-spacing:0.05em;margin:0 0 0.75rem;';
      title.textContent = t.rules_private_section || 'Dodatna pravila apartmaja';

      var body = document.createElement('div');
      body.style.cssText = 'font-size:0.95rem;line-height:1.6;white-space:pre-line;color:#f0fdf4;';
      body.textContent = text;

      section.appendChild(title);
      section.appendChild(body);

      var main = document.querySelector('.rules-body');
      if (main) main.appendChild(section);
    }).catch(function () {});
  })();
  </script>
</body>
</html>
